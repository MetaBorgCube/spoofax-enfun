Module("desugar",[Imports([Import("include/Enfun")]),Strategies([SDefNoArgs("desugar-all",Call(SVar("topdown"),[Call(SVar("repeat"),[CallNoArgs(SVar("desugar"))])]))]),Rules([RDefNoArgs("desugar",RuleNoCond(NoAnnoList(Op("Plus",[Var("e1"),Var("e2")])),NoAnnoList(Op("MethCall",[Var("e1"),NoAnnoList(Str("\"plus\"")),NoAnnoList(List([Var("e2")]))])))),RDefNoArgs("desugar",RuleNoCond(NoAnnoList(Op("Type0",[Var("t")])),NoAnnoList(Op("Type",[Var("t"),NoAnnoList(List([]))])))),RDefNoArgs("desugar",RuleNoCond(NoAnnoList(Op("Not",[Var("e")])),NoAnnoList(Op("MethCall",[Var("e"),NoAnnoList(Str("not")),NoAnnoList(Op("Nil",[]))])))),RDefNoArgs("desugar",RuleNoCond(NoAnnoList(Op("And",[Var("e1"),Var("e2")])),NoAnnoList(Op("MethCall",[Var("e1"),NoAnnoList(Str("and")),NoAnnoList(Op("Cons",[Var("e2"),NoAnnoList(Op("Nil",[]))]))])))),RDefNoArgs("desugar",RuleNoCond(NoAnnoList(Op("Or",[Var("e1"),Var("e2")])),NoAnnoList(Op("MethCall",[Var("e1"),NoAnnoList(Str("or")),NoAnnoList(Op("Cons",[Var("e2"),NoAnnoList(Op("Nil",[]))]))])))),RDefNoArgs("desugar",RuleNoCond(NoAnnoList(Op("Plus",[Var("e1"),Var("e2")])),NoAnnoList(Op("MethCall",[Var("e1"),NoAnnoList(Str("plus")),NoAnnoList(Op("Cons",[Var("e2"),NoAnnoList(Op("Nil",[]))]))])))),RDefNoArgs("desugar",RuleNoCond(NoAnnoList(Op("Mul",[Var("e1"),Var("e2")])),NoAnnoList(Op("MethCall",[Var("e1"),NoAnnoList(Str("times")),NoAnnoList(Op("Cons",[Var("e2"),NoAnnoList(Op("Nil",[]))]))])))),RDefNoArgs("desugar",RuleNoCond(NoAnnoList(Op("Minus",[Var("e1"),Var("e2")])),NoAnnoList(Op("MethCall",[Var("e1"),NoAnnoList(Str("minus")),NoAnnoList(Op("Cons",[Var("e2"),NoAnnoList(Op("Nil",[]))]))])))),RDefNoArgs("desugar",RuleNoCond(NoAnnoList(Op("Eq",[Var("e1"),Var("e2")])),NoAnnoList(Op("MethCall",[Var("e1"),NoAnnoList(Str("eq")),NoAnnoList(Op("Cons",[Var("e2"),NoAnnoList(Op("Nil",[]))]))])))),RDefNoArgs("desugar",RuleNoCond(NoAnnoList(Op("Lt",[Var("e1"),Var("e2")])),NoAnnoList(Op("MethCall",[Var("e1"),NoAnnoList(Str("lt")),NoAnnoList(Op("Cons",[Var("e2"),NoAnnoList(Op("Nil",[]))]))])))),RDefNoArgs("desugar",RuleNoCond(NoAnnoList(Op("Gt",[Var("e1"),Var("e2")])),NoAnnoList(Op("MethCall",[Var("e1"),NoAnnoList(Str("gt")),NoAnnoList(Op("Cons",[Var("e2"),NoAnnoList(Op("Nil",[]))]))])))),RDefNoArgs("desugar",RuleNoCond(NoAnnoList(Op("Leq",[Var("e1"),Var("e2")])),NoAnnoList(Op("MethCall",[Var("e1"),NoAnnoList(Str("leq")),NoAnnoList(Op("Cons",[Var("e2"),NoAnnoList(Op("Nil",[]))]))])))),RDefNoArgs("desugar",RuleNoCond(NoAnnoList(Op("Geq",[Var("e1"),Var("e2")])),NoAnnoList(Op("MethCall",[Var("e1"),NoAnnoList(Str("geq")),NoAnnoList(Op("Cons",[Var("e2"),NoAnnoList(Op("Nil",[]))]))]))))]),Strategies([SDefNoArgs("normalize-all",Call(SVar("innermost-L"),[CallNoArgs(SVar("normalize"))])),SDef("innermost-L",[DefaultVarDec("s")],Call(SVar("bottomup-L"),[Call(SVar("try"),[Seq(CallNoArgs(SVar("s")),Call(SVar("innermost-L"),[CallNoArgs(SVar("s"))]))])])),SDef("bottomup-L",[DefaultVarDec("s")],Seq(Call(SVar("all-l"),[Call(SVar("bottomup-L"),[CallNoArgs(SVar("s"))])]),CallNoArgs(SVar("s"))))]),Rules([RDefNoArgs("normalize",RuleNoCond(NoAnnoList(Op("VarDeclInit",[Var("x"),Var("t"),Var("e")])),NoAnnoList(Op("Seq",[NoAnnoList(List([NoAnnoList(Op("VarDecl",[Var("x"),Var("t")])),NoAnnoList(Op("Assign",[NoAnnoList(Op("Var",[Var("x")])),Var("e")]))]))]))))]),Rules([RDefNoArgs("normalize",RuleNoCond(NoAnnoList(ListTail([NoAnnoList(Op("Seq",[Var(ListVar("stat1*"))]))],As(Var(ListVar("stat2*")),NoAnnoList(ListTail([Wld],Wld))))),NoAnnoList(List([NoAnnoList(Op("Seq",[NoAnnoList(List([Var(ListVar("stat1*")),Var(ListVar("stat2*"))]))]))])))),RDefNoArgs("normalize",RuleNoCond(NoAnnoList(List([Var("stat"),NoAnnoList(Op("Seq",[Var(ListVar("stat*"))]))])),NoAnnoList(List([NoAnnoList(Op("Seq",[NoAnnoList(ListTail([Var("stat")],Var(ListVar("stat*"))))]))])))),RDefNoArgs("normalize",RuleNoCond(NoAnnoList(Op("Block",[NoAnnoList(List([NoAnnoList(Op("Seq",[Var(ListVar("stat1*"))]))]))])),NoAnnoList(Op("Block",[Var(ListVar("stat1*"))])))),RDefNoArgs("normalize",RuleNoCond(NoAnnoList(Op("FunDef",[Var("x"),Var(ListVar("arg*")),Var("t"),NoAnnoList(List([NoAnnoList(Op("Seq",[Var(ListVar("stat*"))]))]))])),NoAnnoList(Op("FunDef",[Var("x"),Var(ListVar("arg*")),Var("t"),Var(ListVar("stat*"))]))))]),Rules([SDefNoArgs("lift-return-all",Call(SVar("alltd"),[Seq(CallNoArgs(SVar("lift-return")),CallNoArgs(SVar("normalize-all")))])),RDefNoArgs("lift-return",Rule(NoAnnoList(Op("FunDef",[Var("x"),Var(ListVar("arg*")),NoAnnoList(Op("Some",[Var("t")])),Var(ListVar("stat1*"))])),NoAnnoList(Op("FunDef",[Var("x"),Var(ListVar("arg*")),NoAnnoList(Op("Some",[Var("t")])),NoAnnoList(Op("Seq",[NoAnnoList(List([NoAnnoList(Op("VarDecl",[Var("y"),Var("t")])),NoAnnoList(Op("Seq",[Var(ListVar("stat2*"))])),NoAnnoList(Op("Return",[NoAnnoList(Op("Var",[Var("y")]))]))]))]))])),Seq(Assign(Var("y"),RootApp(CallNoArgs(SVar("new")))),Assign(Var(ListVar("stat2*")),App(Call(SVar("alltd"),[CallT(SVar("replace-return"),[],[Var("y")])]),Var(ListVar("stat1*"))))))),RDefT("replace-return",[],[DefaultVarDec("y")],RuleNoCond(NoAnnoList(Op("Return",[Var("e")])),NoAnnoList(Op("Assign",[Var("y"),Var("e")])))),RDefNoArgs("lift-return-cs",Rule(NoAnnoList(Op("FunDef",[Var("x"),Var(ListVar("arg*")),NoAnnoList(Op("Some",[NoAnnoList(Op("appl",[NoAnnoList(Op("prod",[NoAnnoList(Op("Cons",[NoAnnoList(Op("lit",[NoAnnoList(Str(":"))])),NoAnnoList(Op("Cons",[NoAnnoList(Op("cf",[NoAnnoList(Op("opt",[NoAnnoList(Op("layout",[]))]))])),NoAnnoList(Op("Cons",[NoAnnoList(Op("cf",[NoAnnoList(Op("sort",[NoAnnoList(Str("Type"))]))])),NoAnnoList(Op("Nil",[]))]))]))])),NoAnnoList(Op("cf",[NoAnnoList(Op("sort",[NoAnnoList(Str("ReturnType"))]))])),NoAnnoList(Op("no-attrs",[]))])),NoAnnoList(Op("Cons",[NoAnnoList(Str(":")),NoAnnoList(Op("Cons",[NoAnnoList(Op("Some",[NoAnnoList(Str(" "))])),NoAnnoList(Op("Cons",[Var("t"),NoAnnoList(Op("Nil",[]))]))]))]))]))])),Var(ListVar("stat1*"))])),NoAnnoList(Op("FunDef",[Var("x"),Var(ListVar("arg*")),NoAnnoList(Op("Some",[NoAnnoList(Op("appl",[NoAnnoList(Op("prod",[NoAnnoList(Op("Cons",[NoAnnoList(Op("lit",[NoAnnoList(Str(":"))])),NoAnnoList(Op("Cons",[NoAnnoList(Op("cf",[NoAnnoList(Op("opt",[NoAnnoList(Op("layout",[]))]))])),NoAnnoList(Op("Cons",[NoAnnoList(Op("cf",[NoAnnoList(Op("sort",[NoAnnoList(Str("Type"))]))])),NoAnnoList(Op("Nil",[]))]))]))])),NoAnnoList(Op("cf",[NoAnnoList(Op("sort",[NoAnnoList(Str("ReturnType"))]))])),NoAnnoList(Op("no-attrs",[]))])),NoAnnoList(Op("Cons",[NoAnnoList(Str(":")),NoAnnoList(Op("Cons",[NoAnnoList(Op("Some",[NoAnnoList(Str(" "))])),NoAnnoList(Op("Cons",[Var("t"),NoAnnoList(Op("Nil",[]))]))]))]))]))])),NoAnnoList(Op("Cons",[NoAnnoList(Op("VarDecl",[Var("y"),Var("t")])),NoAnnoList(Op("Cons",[NoAnnoList(Op("Seq",[Var(ListVar("stat2*"))])),NoAnnoList(Op("Cons",[NoAnnoList(Op("Return",[NoAnnoList(Op("Var",[Var("y")]))])),NoAnnoList(Op("Nil",[]))]))]))]))])),Seq(Assign(Var("y"),RootApp(CallNoArgs(SVar("new")))),Assign(Var(ListVar("stat2*")),App(Call(SVar("alltd"),[CallT(SVar("replace-return"),[],[Var("y")])]),Var(ListVar("stat1*")))))))])])