Module("lib/nbl-library.generated",[Imports([Import("libstratego-lib"),Import("lib/editor-common.generated"),Import("lib/index-library.generated"),Import("lib/analysis-library.generated"),Import("lib/analysis-library-internal.generated")]),Signature([Constructors([OpDecl("Type",ConstType(SortNoArgs("DefDataKind"))),OpDecl("Import",ConstType(SortNoArgs("DefDataKind"))),OpDecl("Transitive",ConstType(SortNoArgs("ImportAnno"))),OpDecl("CurrentFile",ConstType(SortNoArgs("ImportAnno")))])]),Rules([SDefNoArgs("import-transitive",Call(SVar("collect-one"),[Match(NoAnnoList(Op("Transitive",[])))])),SDefNoArgs("import-standard",Not(CallNoArgs(SVar("import-transitive")))),SDefT("import-values",[],[DefaultVarDec("namespace"),DefaultVarDec("path")],BA(CallNoArgs(SVar("index-get-all-values")),NoAnnoList(Op("DefData",[NoAnnoList(ListTail([Var("namespace")],Var("path"))),NoAnnoList(Op("Import",[])),NoAnnoList(Tuple([]))])))),SDefT("import-currentfile-values",[],[DefaultVarDec("namespace")],BA(CallNoArgs(SVar("index-get-all-values")),NoAnnoList(Op("DefData",[NoAnnoList(ListTail([Var("namespace")],NoAnnoList(List([App(CallNoArgs(SVar("index-file-to-string")),RootApp(CallNoArgs(SVar("index-get-current-file"))))])))),NoAnnoList(Op("Import",[])),NoAnnoList(Tuple([]))])))),RDefT("adjust-index-import",[],[DefaultVarDec("namespace"),DefaultVarDec("path")],Rule(Wld,App(CallNoArgs(SVar("concat")),NoAnnoList(List([NoAnnoList(List([NoAnnoList(ListTail([Var("namespace")],Var("path")))])),Var("currentFileImportDefs"),Var("importDefs")]))),[WithClause(Assign(Var("uri"),NoAnnoList(ListTail([Var("namespace")],Var("path"))))),WhereClause(Seq(Assign(Var("allImports"),RootApp(CallT(SVar("import-values"),[],[Var("namespace"),Var("path")]))),Assign(Var("importDefs"),App(Call(SVar("mapconcat"),[CallT(SVar("import-defs"),[],[Var("namespace"),NoAnnoList(List([Var("uri")]))])]),Var("allImports"))))),WhereClause(Seq(Assign(Var("currentfileImports"),RootApp(CallT(SVar("import-currentfile-values"),[],[Var("namespace")]))),Assign(Var("currentFileImportDefs"),App(Call(SVar("mapconcat"),[CallT(SVar("import-defs"),[],[Var("namespace"),NoAnnoList(List([Var("uri")]))])]),Var("currentfileImports")))))])),RDefT("import-defs",[],[DefaultVarDec("namespace"),DefaultVarDec("seen")],Rule(NoAnnoList(Tuple([Var("key"),RootApp(CallNoArgs(SVar("import-standard")))])),NoAnnoList(List([Var("uri")])),[WithClause(Assign(Var("uri"),NoAnnoList(ListTail([Var("namespace")],App(CallNoArgs(SVar("index-uri-path")),Var("key"))))))])),RDefT("import-defs",[],[DefaultVarDec("namespace"),DefaultVarDec("seen")],Rule(NoAnnoList(Tuple([Var("key"),RootApp(CallNoArgs(SVar("import-transitive")))])),App(CallNoArgs(SVar("conc")),NoAnnoList(Tuple([NoAnnoList(List([Var("uri")])),Var("transitiveUris")]))),[WithClause(Seq(Assign(Var("path"),App(CallNoArgs(SVar("index-uri-path")),Var("key"))),Seq(Assign(Var("uri"),NoAnnoList(ListTail([Var("namespace")],Var("path")))),CondChoice(Not(BA(CallNoArgs(SVar("elem")),NoAnnoList(Tuple([Var("uri"),Var("seen")])))),Seq(Assign(Var("allImports"),RootApp(CallT(SVar("import-values"),[],[Var("namespace"),Var("path")]))),Assign(Var("transitiveUris"),App(Call(SVar("mapconcat"),[CallT(SVar("import-defs"),[],[Var("namespace"),NoAnnoList(ListTail([Var("uri")],Var("seen")))])]),Var("allImports")))),Assign(Var("transitiveUris"),NoAnnoList(List([])))))))]))]),Rules([SDefNoArgs("index-diff-constructors",Match(NoAnnoList(Op("DefData",[Wld,NoAnnoList(Op("Type",[])),Wld])))),RDefNoArgs("index-diff-compare",Rule(NoAnnoList(Tuple([NoAnnoList(Op("DefData",[Var("u1"),NoAnnoList(Op("Type",[])),Var("v1")])),NoAnnoList(Op("DefData",[Var("u2"),NoAnnoList(Op("Type",[])),Var("v2")]))])),RootApp(Id),Seq(BA(CallNoArgs(SVar("index-uri-eq")),NoAnnoList(Tuple([Var("u1"),Var("u2")]))),BA(CallNoArgs(SVar("index-key-eq")),NoAnnoList(Tuple([Var("v1"),Var("v2")]))))))]),Rules([RDefNoArgs("constraint-error",RuleNoCond(AnnoList(Var("x"),[NoAnnoList(ListTail([NoAnnoList(Op("Unresolved",[Var("t")]))],Wld))]),NoAnnoList(Tuple([Var("x"),NoAnnoList(StringQuotation1("                                    ",[QStr("Unable to resolve.")]))])))),RDefNoArgs("constraint-error",Rule(Var("definition"),NoAnnoList(Tuple([Var("key"),NoAnnoList(StringQuotation1("                          ",[QStr("Duplicate definition")]))])),Seq(BA(CallNoArgs(SVar("nam-unique")),Var("definition")),Seq(Assign(Var("key"),App(CallNoArgs(SVar("nam-get-definition-key")),Var("definition"))),Seq(Assign(Var("defs"),App(CallNoArgs(SVar("index-lookup-all-scoped-noimports")),Var("key"))),BA(CallNoArgs(SVar("gt")),NoAnnoList(Tuple([App(CallNoArgs(SVar("length")),Var("defs")),NoAnnoList(Int("1"))]))))))))]),Rules([RDefT("index-lookup-typed",[],[DefaultVarDec("type")],Rule(AnnoList(Var("x"),[NoAnnoList(ListTail([Var("namespace")],Var("path")))]),App(CallT(SVar("index-lookup-internal"),[CallT(SVar("index-compare-nametype-equal"),[],[Var("name"),Var("type")])],[Var("ns"),Var("path"),Var("name")]),Var("x")),Seq(Assign(Var("ns"),App(CallNoArgs(SVar("index-namespace-unwrap")),Var("namespace"))),Assign(Var("name"),App(CallNoArgs(SVar("strip-annos")),Var("x")))))),RDefT("index-lookup-all-typed",[],[DefaultVarDec("prefix"),DefaultVarDec("type")],Rule(AnnoList(Var("x"),[NoAnnoList(ListTail([Var("namespace")],Var("path")))]),App(CallT(SVar("index-lookup-all-internal"),[CallT(SVar("index-compare-nametype-substring"),[],[Var("prefix"),Var("type")])],[Var("ns"),Var("path"),Var("prefix")]),Var("x")),Assign(Var("ns"),App(CallNoArgs(SVar("index-namespace-unwrap")),Var("namespace"))))),RDefT("index-compare-nametype-equal",[],[DefaultVarDec("name"),DefaultVarDec("type")],Rule(Var("element"),RootApp(Id),Seq(Assign(Var("uri"),App(CallNoArgs(SVar("index-uri")),Var("element"))),Seq(BA(CallT(SVar("SRTS-EXT-eq-ignore-annos"),[],[Var("name")]),App(CallNoArgs(SVar("index-uri-name")),Var("uri"))),BA(CallT(SVar("nbl-type-eq"),[],[Var("type")]),App(CallNoArgs(SVar("nbl-get-type")),Var("uri"))))))),RDefT("index-compare-nametype-substring",[],[DefaultVarDec("prefix"),DefaultVarDec("type")],Rule(Var("element"),RootApp(Id),Seq(Assign(Var("uri"),App(CallNoArgs(SVar("index-uri")),Var("element"))),Seq(BA(Call(SVar("is-substring"),[Build(Var("prefix"))]),App(CallNoArgs(SVar("index-uri-name")),Var("uri"))),BA(CallT(SVar("nbl-type-eq"),[],[Var("type")]),App(CallNoArgs(SVar("nbl-get-type")),Var("uri"))))))),RDefNoArgs("nbl-get-type",RuleNoCond(Var("uri"),App(CallT(SVar("index-get-data"),[],[NoAnnoList(Op("Type",[]))]),NoAnnoList(Op("Def",[Var("uri")]))))),SDefT("nbl-type-eq",[],[DefaultVarDec("type")],BA(CallNoArgs(SVar("eq")),NoAnnoList(Tuple([RootApp(Id),Var("type")]))))])])